#!/usr/bin/env bash

ICON_EMPTY="󱓼 "
ICON_HAS_WINDOWS="󱨈 "
ICON_ACTIVE="󱓻 "

# Get focused workspace ID
focused_workspace=$(hyprctl activeworkspace 2>/dev/null \
  | grep -o 'workspace ID [0-9]\+' \
  | grep -o '[0-9]\+')

# Initialize tags 1–9 as empty
declare -A tags
for i in {1..9}; do
  tags[$i]="$ICON_EMPTY"
done

# Parse workspace info
current_ws=""
while IFS= read -r line; do
  # Match workspace ID
  if [[ $line =~ ^workspace\ ID\ ([0-9]+) ]]; then
    current_ws="${BASH_REMATCH[1]}"
  # Match window count
  elif [[ $line =~ ^[[:space:]]*windows:\ ([0-9]+) ]]; then
    windows="${BASH_REMATCH[1]}"
    if [[ -n $current_ws && $windows -gt 0 ]]; then
      tags[$current_ws]="$ICON_HAS_WINDOWS"
    fi
  fi
done < <(hyprctl workspaces 2>/dev/null)

# Mark active workspace (overrides other states)
if [[ -n $focused_workspace ]]; then
  tags[$focused_workspace]="$ICON_ACTIVE"
fi

for i in {1..9}; do
  printf "%s" "${tags[$i]}"
done

